{{ $scratch := newScratch }}
{{ $scratch.Set "style" (resources.Get "css/main.css" | postCSS) }}
{{ $scratch.Set "config" (default "config.yml" (index .Params "config")) }}
{{ if .Site.IsServer }}
  {{/* development */}}
  {{ $scratch.Set "config" (default "dev.yml" (index .Params "dev_config")) }}
{{ else }}
  {{/* production */}}
  {{ $scratch.Set "styles" ($scratch.Get "styles" | minify | fingerprint | resources.PostProcess) }}
{{ end }}
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Content Manager</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Kumbh+Sans:wght@100;700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;1,100;1,300;1,400;1,500;1,700&display=swap"
      rel="stylesheet"
    />
    <!-- netlify-cms config -->
    <link href="{{ $scratch.Get "config" }}" type="text/yaml" rel="cms-config-url">
    <!-- Include the script that enables Netlify Identity on this page. -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <!-- Darkreader -->
    <script src="https://cdn.jsdelivr.net/npm/darkreader@4.9.27/darkreader.min.js"></script>
  </head>
  <body>
    <!-- Include the script that builds the page and powers Netlify CMS -->
    <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"></script>
    <!-- Include the script for previewing Hugo shortcodes -->
    <script src="https://sharadcodes.github.io/hugo-shortcodes-netlify-cms/dist/hugo_shortcodes_netlify_cms.js"></script>
    <script src="/theme-assets/editor/job-preview.js"></script>
    <script src="/theme-assets/editor/shortcodes.js"></script>
    <script>
      DarkReader.enable(); // Enable darkreader
      CMS.registerPreviewStyle("{{ ($scratch.Get "style").RelPermalink }}"); // Register preview styles in Netlify

      let LandingPreviewTemplate = createClass({
        render: function () {
          return h(
            "div",
            { class: "job-guides-container" },
            h(
              "div",
              { class: "markdown max-w-none" },
              this.props.widgetFor("body")
            )
          );
        },
      });
      CMS.registerPreviewTemplate("landing", LandingPreviewTemplate);
      CMS.registerPreviewTemplate("leveling-guide", GenericJobGuide);
      CMS.registerPreviewTemplate("basic-guide", GenericJobGuide);
      CMS.registerPreviewTemplate("skills-overview", GenericJobGuide);
      CMS.registerPreviewTemplate("openers", GenericJobGuide);
    </script>
  </body>
</html>
